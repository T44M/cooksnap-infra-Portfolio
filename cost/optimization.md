# cost/optimization.md

## コストを抑えるための方針

このプロジェクトは個人開発のため、なるべく AWS 無料枠に収まるように構成を工夫しています。
その中で、以下のような点を意識して設計しました。

## 主な対策

### Lambda

- メモリは 256MB に設定（十分な処理速度と無料枠内のバランス）
- 実行時間は平均 1〜2 秒以内に収めており、月内の無料回数に十分収まる想定

### DynamoDB

- 課金モードは PAY_PER_REQUEST を選択
- まだデータ量が少ない段階ではプロビジョンドよりもこちらが割安
- GSI も最小限に絞って定義

### S3

- 画像の一時保存先として使用
- ライフサイクルルールで 3 日後に自動削除（ストレージ料金対策）

### CloudWatch

- Logs と最低限の Alarms のみ使用（メトリクスや Insight は未使用）
- データ保持期間も必要最低限に設定

## 現在の月額コスト（想定）

| サービス   | 月額コスト（見積）     |
| ---------- | ---------------------- |
| Lambda     | 無料枠内（~100 万回）  |
| DynamoDB   | 無料枠内               |
| S3         | 数円程度（画像数次第） |
| CloudWatch | 数円〜                 |

※ユーザー数が 〜200 人程度なら、ほぼ無料で運用可能

## 将来のスケールに向けて

- アクセス数が増えてきたら、CloudFront 導入や Lambda 分割も検討
- 定期バッチや画像処理など、重い処理は Fargate や Step Functions へ移行可能
- API 呼び出し回数が増えた場合、Claude API 側の課金がボトルネックになる可能性あり

## まとめ

現時点では「とにかく安く・安全に・手早く」動かすことを優先しています。
無料枠にこだわりつつも、後から負債にならないようにスケールパスを残しておく設計を心がけました。
